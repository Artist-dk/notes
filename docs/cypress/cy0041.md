# **ğŸš€ Running Cypress in CI/CD Pipelines**  
Integrating Cypress with **CI/CD (Continuous Integration / Continuous Deployment)** ensures automated test execution on every code change, reducing the risk of introducing bugs. Popular CI/CD tools like **GitHub Actions, Jenkins, CircleCI, and GitLab CI** allow Cypress tests to run on cloud or local machines without manual intervention.  

---

## **âœ… Why Run Cypress in CI/CD?**
âœ” **Automates Testing**: Ensures that tests are executed on every code change.  
âœ” **Reduces Bugs**: Detects issues early before deployment.  
âœ” **Parallel Execution**: Speeds up test execution by running tests concurrently.  
âœ” **Headless Mode**: Runs tests in the background without opening the browser UI.  
âœ” **Artifacts & Reports**: Captures screenshots, videos, and logs for debugging.  

---

# **ğŸ“Œ 1ï¸âƒ£ Setting Up Cypress in CI/CD**
Before running Cypress in any CI/CD pipeline, ensure you have:  

### **âœ… 1. Installed Cypress as a Dev Dependency**
```bash
npm install cypress --save-dev
```

### **âœ… 2. Added Cypress Scripts in `package.json`**
```json
"scripts": {
  "test": "cypress run",
  "test:headless": "cypress run --headless",
  "test:chrome": "cypress run --browser chrome",
  "test:firefox": "cypress run --browser firefox"
}
```

### **âœ… 3. Ensured a Headless Environment**
Cypress runs headless in CI/CD pipelines, meaning no GUI is needed. You can specify the **browser** (Chromium, Firefox, Edge) or let Cypress default to Electron.

---

# **ğŸ“Œ 2ï¸âƒ£ Running Cypress in GitHub Actions**
GitHub Actions automates testing on every **push, pull request, or scheduled run**.  

### **âœ… Step 1: Create a GitHub Workflow File**
Inside your repository, create `.github/workflows/cypress.yml`.

### **âœ… Step 2: Add the Configuration**
```yaml
name: Cypress Tests

on: [push, pull_request]

jobs:
  cypress-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Install Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: Install Dependencies
        run: npm install

      - name: Run Cypress Tests
        run: npm run test:headless

      - name: Upload Cypress Screenshots & Videos (on failure)
        if: failure()
        uses: actions/upload-artifact@v4
        with:
          name: cypress-artifacts
          path: cypress/screenshots
```

### **âœ… Explanation:**
ğŸ”¹ Runs Cypress tests on every push/pull request.  
ğŸ”¹ Uses Node.js and installs dependencies.  
ğŸ”¹ Runs Cypress in headless mode.  
ğŸ”¹ If a test fails, screenshots and videos are uploaded for debugging.  

---

# **ğŸ“Œ 3ï¸âƒ£ Running Cypress in Jenkins**
Jenkins is a widely used CI/CD tool that can execute Cypress tests.

### **âœ… Step 1: Install Node.js on Jenkins**
If not installed, set up **Node.js** in Jenkins by adding a plugin or manually installing it.

### **âœ… Step 2: Create a Jenkins Pipeline**
Go to **Jenkins â†’ New Item â†’ Pipeline** and add the following script:

```groovy
pipeline {
    agent any
    stages {
        stage('Checkout Code') {
            steps {
                git 'https://github.com/your-repo.git'
            }
        }
        stage('Install Dependencies') {
            steps {
                sh 'npm install'
            }
        }
        stage('Run Cypress Tests') {
            steps {
                sh 'npx cypress run --headless'
            }
        }
        stage('Publish Test Artifacts') {
            post {
                failure {
                    archiveArtifacts artifacts: 'cypress/screenshots/**'
                }
            }
        }
    }
}
```

### **âœ… Explanation:**
ğŸ”¹ **Checks out the code** from GitHub.  
ğŸ”¹ **Installs dependencies** using `npm install`.  
ğŸ”¹ **Runs Cypress in headless mode** using `npx cypress run --headless`.  
ğŸ”¹ **Saves screenshots** if the test fails.  

---

# **ğŸ“Œ 4ï¸âƒ£ Running Cypress in CircleCI**
CircleCI is a **cloud-based CI/CD** that supports Cypress testing.

### **âœ… Step 1: Add a `.circleci/config.yml` File**
Create a `.circleci/config.yml` file in the root directory.

### **âœ… Step 2: Add the Configuration**
```yaml
version: 2.1

jobs:
  cypress-test:
    docker:
      - image: cypress/included:12.17.1
    steps:
      - checkout
      - run: npm install
      - run: npx cypress run --headless

workflows:
  version: 2
  test:
    jobs:
      - cypress-test
```

### **âœ… Explanation:**
ğŸ”¹ Uses **Docker image with Cypress pre-installed** (`cypress/included`).  
ğŸ”¹ Installs dependencies and runs Cypress tests.  
ğŸ”¹ Defines a **workflow** that executes tests.  

---

# **ğŸ“Œ 5ï¸âƒ£ Running Cypress in GitLab CI/CD**
GitLab CI/CD runs Cypress tests on every commit or merge request.

### **âœ… Step 1: Create a `.gitlab-ci.yml` File**
Add a `.gitlab-ci.yml` file to your project.

### **âœ… Step 2: Add the Configuration**
```yaml
stages:
  - test

cypress_tests:
  image: cypress/included:12.17.1
  stage: test
  script:
    - npm install
    - npx cypress run --headless
  artifacts:
    when: always
    paths:
      - cypress/screenshots
      - cypress/videos
```

### **âœ… Explanation:**
ğŸ”¹ Uses **Cypress Docker Image** for testing.  
ğŸ”¹ Runs Cypress in headless mode.  
ğŸ”¹ Saves **screenshots/videos** as artifacts in case of failure.  

---

# **ğŸ“Œ 6ï¸âƒ£ Running Cypress Tests in Parallel (Speeds Up Execution)**
Running tests in parallel reduces execution time in CI/CD.

### **âœ… Step 1: Use Cypress Dashboard for Parallelization**
Cypress Dashboard allows running tests across multiple machines.

```bash
npx cypress run --record --parallel --key YOUR_CYPRESS_DASHBOARD_KEY
```

ğŸ”¹ **`--record`**: Records test results in Cypress Dashboard.  
ğŸ”¹ **`--parallel`**: Splits tests across multiple machines.  
ğŸ”¹ **`--key`**: API key from Cypress Dashboard.  

---

# **ğŸ“Œ 7ï¸âƒ£ Cypress Best Practices for CI/CD**
âœ… **Use Headless Mode**: Speeds up execution and prevents UI delays.  
âœ… **Run Tests in Parallel**: Distributes tests across multiple machines.  
âœ… **Retry Failed Tests**: Use `cypress.json` to enable retries:  
```json
{
  "retries": {
    "runMode": 2,
    "openMode": 1
  }
}
```
âœ… **Capture Screenshots & Videos**: Helps debug failed tests.  
âœ… **Use `cy.intercept()` Instead of UI Actions**: Mock API responses for stable tests.  

---

# **ğŸš€ Whatâ€™s Next?**
Would you like:  
âœ” **Integrating Cypress with Docker?**  
âœ” **Setting Up Cypress Reports in CI/CD?**  
âœ” **Advanced Parallel Execution Strategies?**  

Let me know! ğŸ˜ŠğŸ”¥