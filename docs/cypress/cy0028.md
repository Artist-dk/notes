# **ğŸ”§ Environment Variables in Cypress: `Cypress.env()` & `.env` File for Configurations**  

Environment variables in Cypress allow you to manage **sensitive data, configurations, and environment-specific settings** outside your test scripts. This ensures **security, flexibility, and maintainability** across different testing environments (e.g., dev, staging, production).  

---

## **ğŸ“Œ 1ï¸âƒ£ Why Use Environment Variables in Cypress?**  

âœ… **Avoid Hardcoding Sensitive Data:** Prevents exposing API keys, credentials, and URLs in test scripts.  
âœ… **Easier Configuration Management:** Quickly switch between different environments (e.g., Dev, QA, Production).  
âœ… **Improves Maintainability:** Keeps tests clean by separating logic from configuration.  
âœ… **Ensures Security:** Stores sensitive data separately, preventing accidental leaks in repositories.  

---

## **ğŸ“Œ 2ï¸âƒ£ Setting Environment Variables in Cypress**  

There are **multiple ways** to define environment variables in Cypress:  
1ï¸âƒ£ Using `cypress.config.js` or `cypress.config.ts`  
2ï¸âƒ£ Using the `CYPRESS_` prefix in the terminal  
3ï¸âƒ£ Using a `.env` file with a plugin  
4ï¸âƒ£ Using `Cypress.env()` dynamically in tests  

---

## **ğŸ“Œ 3ï¸âƒ£ Defining Environment Variables in `cypress.config.js`**  

The recommended way to store environment variables is in `cypress.config.js` (or `cypress.config.ts` for TypeScript projects).  

### **âœ… Example: Storing Variables in `cypress.config.js`**  
```javascript
const { defineConfig } = require('cypress');

module.exports = defineConfig({
  e2e: {
    env: {
      baseUrl: 'https://staging.example.com',
      apiKey: '1234567890abcdef',
      adminUser: 'admin@example.com'
    }
  }
});
```
âœ” Stores variables globally and makes them accessible in all tests.  

---

## **ğŸ“Œ 4ï¸âƒ£ Accessing Environment Variables in Test Files (`Cypress.env()`)**  

Use `Cypress.env('variableName')` to retrieve the environment variables inside your tests.  

### **âœ… Example: Using `Cypress.env()` in Tests**
```javascript
describe('Environment Variable Test', () => {
  it('Uses environment variables', () => {
    cy.visit(Cypress.env('baseUrl')); // Visit the base URL
    cy.log('API Key:', Cypress.env('apiKey')); // Log API key
  });
});
```
âœ” Helps dynamically access values without hardcoding them in test files.  

---

## **ğŸ“Œ 5ï¸âƒ£ Setting Environment Variables in the Terminal (`CYPRESS_` Prefix)**  

You can **set variables directly in the terminal** before running tests:  

### **âœ… Example (Mac/Linux)**
```bash
CYPRESS_baseUrl="https://prod.example.com" npx cypress run
```
### **âœ… Example (Windows PowerShell)**
```powershell
$env:CYPRESS_baseUrl="https://prod.example.com"; npx cypress run
```
âœ” **Overrides `cypress.config.js` values temporarily** without modifying the config file.  

---

## **ğŸ“Œ 6ï¸âƒ£ Using a `.env` File for Environment Variables**  

Cypress does **not natively support `.env` files**, but you can use the `cypress-dotenv` plugin to load environment variables from a `.env` file.

### **âœ… Step 1: Install `cypress-dotenv` Plugin**  
```bash
npm install cypress-dotenv --save-dev
```

### **âœ… Step 2: Create a `.env` File**  
Create a `.env` file in your project root directory:  
```
CYPRESS_baseUrl=https://staging.example.com
CYPRESS_apiKey=abcdef123456
CYPRESS_adminUser=admin@example.com
```

### **âœ… Step 3: Update `cypress.config.js` to Use `.env` File**
```javascript
const dotenv = require('cypress-dotenv');
module.exports = {
  e2e: {
    setupNodeEvents(on, config) {
      return dotenv(config);
    }
  }
};
```

### **âœ… Step 4: Use the Variables in Tests**
```javascript
cy.visit(Cypress.env('baseUrl'));
cy.log('API Key:', Cypress.env('apiKey'));
```
âœ” Allows **managing multiple environment variables** in an easy-to-edit `.env` file.  

---

## **ğŸ“Œ 7ï¸âƒ£ Overriding Environment Variables in Tests**  

Cypress allows **overriding environment variables dynamically** at runtime using `Cypress.env()`.

### **âœ… Example: Setting Variables Dynamically in a Test**
```javascript
Cypress.env('baseUrl', 'https://new-environment.example.com');

describe('Dynamic Env Test', () => {
  it('Overrides the base URL', () => {
    cy.visit(Cypress.env('baseUrl'));
  });
});
```
âœ” Useful for **temporary variable changes** without modifying config files.  

---

## **ğŸ“Œ 8ï¸âƒ£ Using Environment Variables in `cypress.json` (Deprecated)**  

ğŸ”´ **Note:** `cypress.json` is deprecated in Cypress 10+ and has been replaced by `cypress.config.js`.  
However, for older Cypress versions (â‰¤9), you can still define environment variables in `cypress.json`.  

```json
{
  "env": {
    "baseUrl": "https://staging.example.com",
    "apiKey": "1234567890abcdef"
  }
}
```
---

## **ğŸ“Œ 9ï¸âƒ£ Example: Managing Different Environments (Dev, QA, Prod)**  

For multiple environments, you can create separate config files:  

ğŸ“‚ **Project Structure:**
```
cypress/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ cypress.dev.json
â”‚   â”œâ”€â”€ cypress.staging.json
â”‚   â”œâ”€â”€ cypress.prod.json
```

### **âœ… Example: `cypress.dev.json`**
```json
{
  "env": {
    "baseUrl": "https://dev.example.com",
    "apiKey": "dev-api-key"
  }
}
```

### **âœ… Example: `cypress.prod.json`**
```json
{
  "env": {
    "baseUrl": "https://prod.example.com",
    "apiKey": "prod-api-key"
  }
}
```

### **âœ… Run Cypress with a Specific Environment**
```bash
npx cypress run --config-file cypress.prod.json
```
âœ” Helps **switch between environments easily** without modifying test scripts.  

---

## **ğŸ“Œ ğŸ”Ÿ Best Practices for Using Environment Variables in Cypress**  

âœ… **Use `cypress.config.js` for most environment variables**  
âœ… **Use `.env` files for sensitive data, with `cypress-dotenv` plugin**  
âœ… **Avoid hardcoding secrets in test files** (Use `Cypress.env()`)  
âœ… **Use `CYPRESS_` prefix for setting variables in the terminal**  
âœ… **Store different environment configs separately (`cypress.dev.json`, `cypress.prod.json`)**  
âœ… **Override variables dynamically using `Cypress.env('key', 'value')`**  

---

## **ğŸš€ Whatâ€™s Next?**  

Would you like:  
âœ” **Examples of using environment variables with API testing (`cy.request()`)?**  
âœ” **Custom commands that load environment variables dynamically?**  
âœ” **Using environment variables for authentication (JWT, cookies, session storage)?**  

Let me know! ğŸ˜ŠğŸ”¥