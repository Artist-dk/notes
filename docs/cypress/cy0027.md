# **ðŸ”¥ Custom Commands in Cypress: Creating Reusable Cypress Commands (`Cypress.Commands.add()`) ðŸš€**  

Custom commands in Cypress help **reduce duplication, improve test maintainability, and simplify complex actions** by encapsulating repetitive tasks into reusable functions.  

---

## **ðŸ“Œ 1ï¸âƒ£ What Are Custom Commands in Cypress?**  

ðŸ”¹ Cypress provides **built-in commands** like `cy.visit()`, `cy.get()`, and `cy.click()`.  
ðŸ”¹ However, when certain test actions **repeat frequently** (e.g., login, form submissions, API calls), it's better to **create custom commands** using `Cypress.Commands.add()`.  
ðŸ”¹ Custom commands allow **writing reusable test logic** for commonly used actions.  

âœ… **Benefits of Custom Commands:**  
âœ” **Reduces repetitive code** across test files  
âœ” **Improves maintainability** by centralizing logic  
âœ” **Enhances readability** by making tests cleaner  
âœ” **Encapsulates complex actions** into single reusable functions  

---

## **ðŸ“Œ 2ï¸âƒ£ Creating a Custom Command with `Cypress.Commands.add()`**  

Cypress allows adding custom commands using:  
```javascript
Cypress.Commands.add('commandName', (param1, param2, ...) => { 
  // Custom logic here 
});
```
Where:  
- `'commandName'` â†’ Name of the command (e.g., `'login'`, `'fillForm'`).  
- `(param1, param2, ...)` â†’ Parameters the command will accept.  

---

## **ðŸ“Œ 3ï¸âƒ£ Example: Creating a `login` Command**  

Let's say we **frequently log in** across multiple tests. Instead of repeating the login steps, we can **create a reusable command**.  

### **âœ… Define a Custom Command for Login (`commands.js`)**
```javascript
Cypress.Commands.add('login', (username, password) => {
  cy.visit('/login');

  cy.get('#username').type(username);
  cy.get('#password').type(password);
  cy.get('#loginBtn').click();

  cy.get('.welcome-message').should('contain', `Welcome, ${username}`);
});
```

### **âœ… Use the `login` Command in Tests**
```javascript
describe('Login Tests', () => {
  it('Logs in as a regular user', () => {
    cy.login('testUser', 'testPass');
  });

  it('Logs in as an admin', () => {
    cy.login('adminUser', 'adminPass');
  });
});
```

### **ðŸ” How It Works?**  
âœ” `cy.login('testUser', 'testPass')` replaces multiple Cypress commands.  
âœ” Makes the test **cleaner and more readable**.  
âœ” Reduces **duplication** and improves maintainability.  

---

## **ðŸ“Œ 4ï¸âƒ£ Where to Define Custom Commands?**  

Custom commands should be placed inside the `cypress/support/commands.js` file:  
ðŸ“‚ **Project Structure:**  
```
cypress/
â”‚â”€â”€ integration/
â”‚â”€â”€ support/
â”‚   â”‚â”€â”€ commands.js  ðŸ‘ˆ (Define custom commands here)
â”‚   â”‚â”€â”€ index.js  ðŸ‘ˆ (Automatically loads commands.js)
```
âœ… Cypress **automatically loads `commands.js`** when running tests.  

---

## **ðŸ“Œ 5ï¸âƒ£ Creating More Advanced Custom Commands**  

### **âœ… Example: `fillForm` - Custom Command for Form Submission**
```javascript
Cypress.Commands.add('fillForm', (name, email, message) => {
  cy.get('#name').type(name);
  cy.get('#email').type(email);
  cy.get('#message').type(message);
  cy.get('#submitBtn').click();
});
```

### **âœ… Using the `fillForm` Command in Tests**
```javascript
describe('Form Tests', () => {
  it('Fills and submits the contact form', () => {
    cy.fillForm('John Doe', 'john@example.com', 'Hello, Cypress!');
  });
});
```
âœ” **Reduces form submission duplication** in multiple tests.  
âœ” Makes **tests easier to maintain** if the form changes.  

---

## **ðŸ“Œ 6ï¸âƒ£ Custom Commands with Assertions**  

You can include **assertions inside custom commands** for validation.

### **âœ… Example: `verifyLoginSuccess` Custom Command**
```javascript
Cypress.Commands.add('verifyLoginSuccess', (username) => {
  cy.get('.welcome-message').should('contain', `Welcome, ${username}`);
});
```

### **âœ… Using the `verifyLoginSuccess` Command**
```javascript
cy.login('testUser', 'testPass');
cy.verifyLoginSuccess('testUser');
```
âœ” Ensures **login was successful** after calling `cy.login()`.  

---

## **ðŸ“Œ 7ï¸âƒ£ Custom Commands for API Requests**  

Cypress allows creating **custom commands for API testing**.

### **âœ… Example: `apiLogin` - Login via API Instead of UI**
```javascript
Cypress.Commands.add('apiLogin', (username, password) => {
  cy.request({
    method: 'POST',
    url: '/api/login',
    body: { username, password }
  }).then((response) => {
    expect(response.status).to.eq(200);
    cy.setCookie('authToken', response.body.token);
  });
});
```

### **âœ… Using `apiLogin` to Skip UI Login**
```javascript
describe('Dashboard Tests', () => {
  beforeEach(() => {
    cy.apiLogin('testUser', 'testPass');
    cy.visit('/dashboard');
  });

  it('Checks dashboard elements', () => {
    cy.get('.dashboard-header').should('be.visible');
  });
});
```
âœ” **Speeds up tests** by skipping UI login.  
âœ” **Useful for API-first authentication**.  

---

## **ðŸ“Œ 8ï¸âƒ£ Custom Commands for Conditional Actions**  

Cypress does not have built-in conditional logic (`if-else`). Custom commands **can handle conditions** dynamically.

### **âœ… Example: `clickIfVisible` - Clicking Only if an Element Exists**
```javascript
Cypress.Commands.add('clickIfVisible', (selector) => {
  cy.get('body').then(($body) => {
    if ($body.find(selector).length > 0) {
      cy.get(selector).click();
    } else {
      cy.log(`Element ${selector} not found`);
    }
  });
});
```

### **âœ… Usage Example**
```javascript
cy.clickIfVisible('#optionalButton'); // Clicks if the button exists
```
âœ” Prevents errors if an element is missing.  
âœ” Useful for handling **dynamic UI changes**.  

---

## **ðŸ“Œ 9ï¸âƒ£ Overriding Cypress Built-in Commands**  

You can **modify built-in Cypress commands** using `Cypress.Commands.overwrite()`.

### **âœ… Example: Overriding `visit()` to Always Set a Header**
```javascript
Cypress.Commands.overwrite('visit', (originalFn, url, options) => {
  options = options || {};
  options.headers = { Authorization: 'Bearer test-token' };
  return originalFn(url, options);
});
```

### **âœ… Using Overridden `visit()`**
```javascript
cy.visit('/dashboard'); // Automatically includes the header
```
âœ” Ensures **all requests include authentication headers**.  

---

## **ðŸ“Œ ðŸ”Ÿ Summary: Best Practices for Custom Commands**  

âœ… **Use `Cypress.Commands.add()`** for reusable logic  
âœ… **Store commands in `cypress/support/commands.js`**  
âœ… **Use parameters to make commands flexible**  
âœ… **Keep commands modular (1 function = 1 responsibility)**  
âœ… **Include assertions in custom commands when necessary**  
âœ… **Use `Cypress.Commands.overwrite()` to modify built-in functions**  
âœ… **Use API commands (`cy.request()`) to optimize test execution**  

---

## **ðŸš€ Whatâ€™s Next?**  

Would you like:  
âœ” **Custom commands for handling modals, alerts, or popups?**  
âœ” **Advanced API testing techniques with Cypress?**  
âœ” **Custom commands for handling file uploads?**  

Let me know! ðŸ˜ŠðŸ”¥